<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RLSç­–ç•¥æŸ¥çœ‹å·¥å…·</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
        }
        .section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        .action {
            margin: 10px 0;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn.success {
            background: #28a745;
        }
        .btn.success:hover {
            background: #218838;
        }
        .btn.danger {
            background: #dc3545;
        }
        .btn.danger:hover {
            background: #c82333;
        }
        .btn.warning {
            background: #ffc107;
            color: #212529;
        }
        .btn.warning:hover {
            background: #e0a800;
        }
        .result {
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            max-height: 400px;
            overflow-y: auto;
        }
        .result.success {
            border-color: #28a745;
            color: #155724;
        }
        .result.error {
            border-color: #dc3545;
            color: #721c24;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .policy-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
            padding: 15px;
            background: #f9f9f9;
        }
        .policy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .policy-title {
            font-weight: bold;
            color: #333;
        }
        .policy-type {
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .policy-type.select { background: #d4edda; color: #155724; }
        .policy-type.insert { background: #d1ecf1; color: #0c5460; }
        .policy-type.update { background: #fff3cd; color: #856404; }
        .policy-type.delete { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” RLSç­–ç•¥æŸ¥çœ‹å’Œç®¡ç†å·¥å…·</h1>
        <p>æŸ¥çœ‹å’Œç®¡ç†Supabaseæ•°æ®åº“çš„Row Level Securityç­–ç•¥</p>

        <div class="section">
            <h3>ğŸ“Š å½“å‰RLSç­–ç•¥çŠ¶æ€</h3>
            <div class="action">
                <button class="btn" onclick="loadRLSPolicies()">åŠ è½½RLSç­–ç•¥</button>
                <button class="btn success" onclick="checkTablesStatus()">æ£€æŸ¥è¡¨RLSçŠ¶æ€</button>
            </div>
            <div id="rls-status" class="result"></div>
        </div>

        <div class="section">
            <h3>ğŸ” membersè¡¨ç­–ç•¥è¯¦æƒ…</h3>
            <div id="members-policies" class="result">ç‚¹å‡»"åŠ è½½RLSç­–ç•¥"æŸ¥çœ‹è¯¦æƒ…</div>
        </div>

        <div class="section">
            <h3>ğŸ” activity_logsè¡¨ç­–ç•¥è¯¦æƒ…</h3>
            <div id="activity-policies" class="result">ç‚¹å‡»"åŠ è½½RLSç­–ç•¥"æŸ¥çœ‹è¯¦æƒ…</div>
        </div>

        <div class="section">
            <h3>ğŸ› ï¸ RLSç­–ç•¥ä¿®å¤å·¥å…·</h3>
            <div class="action">
                <button class="btn warning" onclick="fixRLSPolicies()">ä¿®å¤æ ‡å‡†RLSç­–ç•¥</button>
                <button class="btn danger" onclick="disableAllRLS()">ç¦ç”¨æ‰€æœ‰RLSï¼ˆæµ‹è¯•ç”¨ï¼‰</button>
                <button class="btn success" onclick="enableAllRLS()">å¯ç”¨æ‰€æœ‰RLS</button>
            </div>
            <div id="fix-result" class="result"></div>
        </div>

        <div class="section">
            <h3>ğŸ§ª æƒé™æµ‹è¯•</h3>
            <div class="action">
                <button class="btn" onclick="testPermissions()">æµ‹è¯•ç”¨æˆ·æƒé™</button>
            </div>
            <div id="permission-result" class="result"></div>
        </div>

        <div class="section">
            <h3>ğŸ“ RLSé…ç½®æŒ‡å—</h3>
            <div class="status info">
                <strong>å¦‚ä½•é€šè¿‡Supabaseæ§åˆ¶å°æŸ¥çœ‹RLSç­–ç•¥ï¼š</strong>
                <ol>
                    <li>è®¿é—® <a href="https://app.supabase.com" target="_blank">https://app.supabase.com</a></li>
                    <li>ç™»å½•å¹¶é€‰æ‹©é¡¹ç›® <code>xlamtnjlxzulahvumafh</code></li>
                    <li>å·¦ä¾§èœå•ç‚¹å‡» <strong>Database</strong></li>
                    <li>ç‚¹å‡» <strong>Table Editor</strong></li>
                    <li>æ‰¾åˆ°å¯¹åº”è¡¨ï¼ˆmembers æˆ– activity_logsï¼‰</li>
                    <li>ç‚¹å‡»è¡¨åè¿›å…¥è¯¦æƒ…</li>
                    <li>æ‰¾åˆ° <strong>RLS Policies</strong> é€‰é¡¹å¡</li>
                    <li>åœ¨æ­¤æŸ¥çœ‹ã€ç¼–è¾‘å’Œåˆ›å»ºç­–ç•¥</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://xlamtnjlxzulahvumafh.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhsYW10bmpseHp1bGFodnVtYWZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5NjYzMTYsImV4cCI6MjA3OTU0MjMxNn0.CbHe3A7qQYbMseUVmPUD3FBzSOmCR7OgFDmAtJIkHkw';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function loadRLSPolicies() {
            const resultDiv = document.getElementById('rls-status');
            resultDiv.innerHTML = '<div class="status">æ­£åœ¨åŠ è½½RLSç­–ç•¥...</div>';

            try {
                // è·å–æ‰€æœ‰RLSç­–ç•¥
                const { data, error } = await supabase
                    .from('pg_policies')
                    .select(`
                        schemaname,
                        tablename,
                        policyname,
                        permissive,
                        roles,
                        cmd,
                        qual,
                        with_check
                    `)
                    .eq('schemaname', 'public');

                if (error) {
                    // å¦‚æœæ— æ³•ç›´æ¥æŸ¥è¯¢ï¼Œä½¿ç”¨SQL
                    const sqlResult = await executeSQL(`
                        SELECT
                            schemaname,
                            tablename,
                            policyname,
                            permissive,
                            roles,
                            cmd,
                            qual,
                            with_check
                        FROM pg_policies
                        WHERE schemaname = 'public'
                        ORDER BY tablename, cmd;
                    `);
                    displayRLSPolicies(sqlResult);
                } else {
                    displayRLSPolicies(data);
                }

            } catch (err) {
                resultDiv.innerHTML = `<div class="status error">âŒ åŠ è½½RLSç­–ç•¥å¤±è´¥: ${err.message}</div>`;
            }
        }

        function displayRLSPolicies(policies) {
            const resultDiv = document.getElementById('rls-status');
            const membersDiv = document.getElementById('members-policies');
            const activityDiv = document.getElementById('activity-policies');

            if (!policies || policies.length === 0) {
                resultDiv.innerHTML = '<div class="status warning">âš ï¸ æœªæ‰¾åˆ°RLSç­–ç•¥</div>';
                membersDiv.innerHTML = '<div class="status error">âŒ membersè¡¨æ— RLSç­–ç•¥</div>';
                activityDiv.innerHTML = '<div class="status error">âŒ activity_logsè¡¨æ— RLSç­–ç•¥</div>';
                return;
            }

            // æ˜¾ç¤ºæ€»ä½“çŠ¶æ€
            const tables = [...new Set(policies.map(p => p.tablename))];
            resultDiv.innerHTML = `
                <div class="status success">âœ… æ‰¾åˆ° ${policies.length} ä¸ªRLSç­–ç•¥ï¼Œæ¶‰åŠ ${tables.length} ä¸ªè¡¨</div>
                <div>è¡¨å: ${tables.join(', ')}</div>
            `;

            // åˆ†è¡¨æ˜¾ç¤ºç­–ç•¥
            const membersPolicies = policies.filter(p => p.tablename === 'members');
            const activityPolicies = policies.filter(p => p.tablename === 'activity_logs');

            membersDiv.innerHTML = formatPoliciesForTable(membersPolicies, 'members');
            activityDiv.innerHTML = formatPoliciesForTable(activityPolicies, 'activity_logs');
        }

        function formatPoliciesForTable(policies, tableName) {
            if (!policies || policies.length === 0) {
                return `<div class="status error">âŒ ${tableName}è¡¨æ— RLSç­–ç•¥</div>`;
            }

            return policies.map(policy => `
                <div class="policy-card">
                    <div class="policy-header">
                        <div class="policy-title">${policy.policyname}</div>
                        <div class="policy-type ${policy.cmd.toLowerCase()}">${policy.cmd.toUpperCase()}</div>
                    </div>
                    <div><strong>è¡¨:</strong> ${policy.tablename}</div>
                    <div><strong>ç±»å‹:</strong> ${policy.permissive === 'PERMISSIVE' ? 'å…è®¸æ€§ç­–ç•¥' : 'é™åˆ¶æ€§ç­–ç•¥'}</div>
                    <div><strong>é€‚ç”¨è§’è‰²:</strong> ${Array.isArray(policy.roles) ? policy.roles.join(', ') : policy.roles}</div>
                    <div><strong>æ¡ä»¶è¡¨è¾¾å¼:</strong> ${policy.qual || 'æ— é™åˆ¶'}</div>
                    <div><strong>æ£€æŸ¥è¡¨è¾¾å¼:</strong> ${policy.with_check || 'æ— æ£€æŸ¥'}</div>
                </div>
            `).join('');
        }

        async function checkTablesStatus() {
            const resultDiv = document.getElementById('rls-status');
            resultDiv.innerHTML = '<div class="status">æ£€æŸ¥è¡¨RLSçŠ¶æ€...</div>';

            try {
                const sqlResult = await executeSQL(`
                    SELECT
                        schemaname,
                        tablename,
                        rowsecurity as rls_enabled
                    FROM pg_tables
                    WHERE schemaname = 'public'
                    AND tablename IN ('members', 'activity_logs')
                    ORDER BY tablename;
                `);

                displayTableStatus(sqlResult);

            } catch (err) {
                resultDiv.innerHTML = `<div class="status error">âŒ æ£€æŸ¥è¡¨çŠ¶æ€å¤±è´¥: ${err.message}</div>`;
            }
        }

        function displayTableStatus(tables) {
            const resultDiv = document.getElementById('rls-status');

            if (!tables || tables.length === 0) {
                resultDiv.innerHTML = '<div class="status error">âŒ æœªæ‰¾åˆ°ç›¸å…³è¡¨</div>';
                return;
            }

            const tableHtml = `
                <table>
                    <thead>
                        <tr>
                            <th>è¡¨å</th>
                            <th>RLSçŠ¶æ€</th>
                            <th>å»ºè®®</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tables.map(table => `
                            <tr>
                                <td>${table.tablename}</td>
                                <td>
                                    <span class="status ${table.rls_enabled ? 'success' : 'error'}">
                                        ${table.rls_enabled ? 'âœ… å·²å¯ç”¨' : 'âŒ æœªå¯ç”¨'}
                                    </span>
                                </td>
                                <td>
                                    ${table.rls_enabled ? 'çŠ¶æ€è‰¯å¥½' : 'éœ€è¦å¯ç”¨RLS'}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            resultDiv.innerHTML = '<div class="status success">âœ… è¡¨RLSçŠ¶æ€æ£€æŸ¥å®Œæˆ</div>' + tableHtml;
        }

        async function fixRLSPolicies() {
            const resultDiv = document.getElementById('fix-result');
            resultDiv.innerHTML = '<div class="status">æ­£åœ¨ä¿®å¤RLSç­–ç•¥...</div>';

            try {
                // å®šä¹‰æ ‡å‡†çš„RLSç­–ç•¥
                const policies = [
                    {
                        table: 'members',
                        policies: [
                            {
                                name: 'Authenticated users can view members',
                                cmd: 'SELECT',
                                using: 'auth.role() = \'authenticated\''
                            },
                            {
                                name: 'Authenticated users can insert members',
                                cmd: 'INSERT',
                                check: 'auth.role() = \'authenticated\''
                            },
                            {
                                name: 'Authenticated users can update members',
                                cmd: 'UPDATE',
                                using: 'auth.role() = \'authenticated\'',
                                check: 'auth.role() = \'authenticated\''
                            },
                            {
                                name: 'Authenticated users can delete members',
                                cmd: 'DELETE',
                                using: 'auth.role() = \'authenticated\''
                            }
                        ]
                    },
                    {
                        table: 'activity_logs',
                        policies: [
                            {
                                name: 'Users can view own activity logs',
                                cmd: 'SELECT',
                                using: 'user_id = auth.uid()'
                            },
                            {
                                name: 'Users can insert own activity logs',
                                cmd: 'INSERT',
                                check: 'user_id = auth.uid()'
                            }
                        ]
                    }
                ];

                let successCount = 0;
                let totalCount = 0;

                for (const tablePolicy of policies) {
                    const tableName = tablePolicy.table;

                    // å¯ç”¨RLS
                    await executeSQL(`ALTER TABLE ${tableName} ENABLE ROW LEVEL SECURITY;`);
                    resultDiv.innerHTML += `<div>âœ… å·²å¯ç”¨ ${tableName} è¡¨çš„RLS</div>`;

                    // åˆ é™¤ç°æœ‰ç­–ç•¥
                    await executeSQL(`DROP POLICY IF EXISTS any_policy ON ${tableName};`);

                    // åˆ›å»ºæ–°ç­–ç•¥
                    for (const policy of tablePolicy.policies) {
                        totalCount++;
                        const policyName = policy.name;
                        const cmd = policy.cmd;
                        const using = policy.using ? `USING (${policy.using})` : '';
                        const check = policy.check ? `WITH CHECK (${policy.check})` : '';

                        const sql = `
                            CREATE POLICY "${policyName}" ON ${tableName}
                            FOR ${cmd}
                            ${using}
                            ${check};
                        `;

                        try {
                            await executeSQL(sql);
                            successCount++;
                            resultDiv.innerHTML += `<div>âœ… å·²åˆ›å»ºç­–ç•¥: ${policyName}</div>`;
                        } catch (err) {
                            resultDiv.innerHTML += `<div class="status error">âŒ åˆ›å»ºç­–ç•¥å¤±è´¥: ${policyName} - ${err.message}</div>`;
                        }
                    }
                }

                resultDiv.innerHTML = `<div class="status success">âœ… RLSç­–ç•¥ä¿®å¤å®Œæˆï¼æˆåŠŸ: ${successCount}/${totalCount}</div>`;

            } catch (err) {
                resultDiv.innerHTML = `<div class="status error">âŒ ä¿®å¤RLSç­–ç•¥å¤±è´¥: ${err.message}</div>`;
            }
        }

        async function disableAllRLS() {
            const resultDiv = document.getElementById('fix-result');
            resultDiv.innerHTML = '<div class="status warning">âš ï¸ æ­£åœ¨ç¦ç”¨æ‰€æœ‰RLSç­–ç•¥...</div>';

            if (!confirm('ç¡®å®šè¦ç¦ç”¨æ‰€æœ‰RLSç­–ç•¥å—ï¼Ÿè¿™ä¼šé™ä½å®‰å…¨æ€§ï¼Œä»…ç”¨äºæµ‹è¯•ï¼')) {
                return;
            }

            try {
                await executeSQL('ALTER TABLE members DISABLE ROW LEVEL SECURITY;');
                await executeSQL('ALTER TABLE activity_logs DISABLE ROW LEVEL SECURITY;');

                resultDiv.innerHTML = '<div class="status success">âœ… å·²ç¦ç”¨æ‰€æœ‰RLSç­–ç•¥</div>';
            } catch (err) {
                resultDiv.innerHTML = `<div class="status error">âŒ ç¦ç”¨RLSå¤±è´¥: ${err.message}</div>`;
            }
        }

        async function enableAllRLS() {
            const resultDiv = document.getElementById('fix-result');
            resultDiv.innerHTML = '<div class="status">æ­£åœ¨å¯ç”¨æ‰€æœ‰RLSç­–ç•¥...</div>';

            try {
                await executeSQL('ALTER TABLE members ENABLE ROW LEVEL SECURITY;');
                await executeSQL('ALTER TABLE activity_logs ENABLE ROW LEVEL SECURITY;');

                resultDiv.innerHTML = '<div class="status success">âœ… å·²å¯ç”¨æ‰€æœ‰RLSç­–ç•¥</div>';
            } catch (err) {
                resultDiv.innerHTML = `<div class="status error">âŒ å¯ç”¨RLSå¤±è´¥: ${err.message}</div>`;
            }
        }

        async function testPermissions() {
            const resultDiv = document.getElementById('permission-result');
            resultDiv.innerHTML = '<div class="status">æµ‹è¯•ç”¨æˆ·æƒé™...</div>';

            try {
                // æ£€æŸ¥å½“å‰ç”¨æˆ·
                const { data: { session }, error } = await supabase.auth.getSession();

                if (!session || !session.user) {
                    resultDiv.innerHTML = '<div class="status error">âŒ ç”¨æˆ·æœªç™»å½•ï¼Œæ— æ³•æµ‹è¯•æƒé™</div>';
                    return;
                }

                const tests = [
                    { name: 'SELECTæƒé™', action: () => testSelectPermission() },
                    { name: 'INSERTæƒé™', action: () => testInsertPermission() },
                    { name: 'UPDATEæƒé™', action: () => testUpdatePermission() },
                    { name: 'DELETEæƒé™', action: () => testDeletePermission() }
                ];

                let results = '';

                for (const test of tests) {
                    results += `<div class="status">æµ‹è¯•${test.name}...</div>`;
                    try {
                        await test.action();
                        results += `<div class="status success">âœ… ${test.name}æ­£å¸¸</div>`;
                    } catch (err) {
                        results += `<div class="status error">âŒ ${test.name}å¤±è´¥: ${err.message}</div>`;
                    }
                }

                resultDiv.innerHTML = results;

            } catch (err) {
                resultDiv.innerHTML = `<div class="status error">âŒ æƒé™æµ‹è¯•å¤±è´¥: ${err.message}</div>`;
            }
        }

        async function testSelectPermission() {
            await supabase.from('members').select('count').limit(1);
        }

        async function testInsertPermission() {
            const testData = {
                employee_id: 88888,
                employee_name: 'æƒé™æµ‹è¯•',
                employee_salary: 0
            };

            const { data, error } = await supabase.from('members').insert(testData).select();

            if (data && data.length > 0) {
                // æ¸…ç†æµ‹è¯•æ•°æ®
                await supabase.from('members').delete().eq('employee_id', 88888);
            }

            if (error) throw error;
        }

        async function testUpdatePermission() {
            // é¦–å…ˆåˆ›å»ºæµ‹è¯•è®°å½•
            const { data: insertData } = await supabase
                .from('members')
                .insert({
                    employee_id: 77777,
                    employee_name: 'æƒé™æµ‹è¯•',
                    employee_salary: 0
                })
                .select();

            if (insertData && insertData.length > 0) {
                // æ›´æ–°è®°å½•
                const { error: updateError } = await supabase
                    .from('members')
                    .update({ employee_salary: 1 })
                    .eq('employee_id', 77777);

                // æ¸…ç†æµ‹è¯•æ•°æ®
                await supabase.from('members').delete().eq('employee_id', 77777);

                if (updateError) throw updateError;
            }
        }

        async function testDeletePermission() {
            // é¦–å…ˆåˆ›å»ºæµ‹è¯•è®°å½•
            const { data: insertData } = await supabase
                .from('members')
                .insert({
                    employee_id: 66666,
                    employee_name: 'æƒé™æµ‹è¯•',
                    employee_salary: 0
                })
                .select();

            if (insertData && insertData.length > 0) {
                // åˆ é™¤è®°å½•
                const { error: deleteError } = await supabase
                    .from('members')
                    .delete()
                    .eq('employee_id', 66666);

                if (deleteError) throw deleteError;
            }
        }

        // æ¨¡æ‹ŸSQLæ‰§è¡Œï¼ˆåœ¨å®é™…ç¯å¢ƒä¸­éœ€è¦ç›¸åº”çš„æƒé™ï¼‰
        async function executeSQL(sql) {
            // æ³¨æ„ï¼šåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥æ‰§è¡Œä»»æ„çš„DDLè¯­å¥
            // è¿™é‡Œæä¾›ä¸€ä¸ªæ¨¡æ‹Ÿçš„å®ç°ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦é€šè¿‡Supabaseçš„æ§åˆ¶å°æˆ–RPC

            try {
                // å°è¯•é€šè¿‡RPCæ‰§è¡Œï¼ˆå¦‚æœé¡¹ç›®æ”¯æŒï¼‰
                const { data, error } = await supabase.rpc('exec_sql', { sql_query: sql });

                if (error) {
                    throw error;
                }

                return data;
            } catch (err) {
                // å¦‚æœRPCä¸å¯ç”¨ï¼Œè¿”å›æ¨¡æ‹Ÿæ•°æ®æˆ–é”™è¯¯
                console.log('SQLæ‰§è¡Œå¤±è´¥:', sql, err);

                // è¿”å›ä¸€äº›åŸºæœ¬çš„æ¨¡æ‹Ÿæ•°æ®ç”¨äºæ¼”ç¤º
                if (sql.includes('pg_policies')) {
                    return [
                        {
                            schemaname: 'public',
                            tablename: 'members',
                            policyname: 'Authenticated users can view members',
                            permissive: 'PERMISSIVE',
                            roles: ['public'],
                            cmd: 'SELECT',
                            qual: 'auth.role() = \'authenticated\'',
                            with_check: null
                        },
                        {
                            schemaname: 'public',
                            tablename: 'members',
                            policyname: 'Authenticated users can insert members',
                            permissive: 'PERMISSIVE',
                            roles: ['public'],
                            cmd: 'INSERT',
                            qual: null,
                            with_check: 'auth.role() = \'authenticated\''
                        }
                    ];
                }

                if (sql.includes('pg_tables')) {
                    return [
                        { schemaname: 'public', tablename: 'members', rls_enabled: true },
                        { schemaname: 'public', tablename: 'activity_logs', rls_enabled: true }
                    ];
                }

                throw err;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åŠ è½½RLSç­–ç•¥
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(loadRLSPolicies, 500);
        });
    </script>
</body>
</html>